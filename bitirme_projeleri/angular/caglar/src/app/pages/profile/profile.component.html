<div class="profile-container">
  <div class="profile-header">
    <h1>Profil</h1>
    <div *ngIf="currentUser" class="user-info">
      <h2>{{currentUser.name}} {{currentUser.surname}}</h2>
      <p class="user-role">{{currentUser.type === 'student' ? 'Student' : 'Instructor'}}</p>
      <p class="user-email">{{currentUser.email}}</p>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading">
    <p>YÃ¼kleniyor...</p>
  </div>

  <!-- Ã–ÄŸrenci GÃ¶rÃ¼nÃ¼mÃ¼ -->
  <div *ngIf="!isLoading && currentUser?.type === 'student'" class="student-section">
    <h3>KayÄ±tlÄ± KurslarÄ±m</h3>
    <div *ngIf="userCourses.length === 0" class="no-courses">
      <p>HenÃ¼z hiÃ§bir kursa kayÄ±t olmadÄ±nÄ±z.</p>
      <a routerLink="/courses" class="btn btn-primary">KurslarÄ± Ä°ncele</a>
    </div>
    
    <div *ngIf="userCourses.length > 0" class="courses-grid">
      <div *ngFor="let course of userCourses" class="course-card">
        <div class="course-icon">
          <i *ngIf="course.icon" [class]="course.icon"></i>
          <span *ngIf="!course.icon">ðŸ“š</span>
        </div>
        <h4>{{course.coursesTitle}}</h4>
        <p>{{course.description}}</p>
        <p class="instructor">Instructor: {{course.Instructor}}</p>
        <div class="progress-section">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="getCourseProgress(course)"></div>
          </div>
          <span class="progress-text">%{{getCourseProgress(course)}} tamamlandÄ±</span>
        </div>
        
        <!-- Comment Ekleme BÃ¶lÃ¼mÃ¼ -->
        <div class="comment-section">
          <div class="comment-form">
            <textarea 
              [(ngModel)]="commentTexts[course.id]" 
              placeholder="Bu kurs hakkÄ±nda yorumunuzu yazÄ±n..."
              class="comment-input"
              rows="3">
            </textarea>
            <button 
              (click)="addComment(course.id, commentTexts[course.id])" 
              class="btn btn-primary btn-sm"
              [disabled]="!commentTexts[course.id] || commentTexts[course.id].trim() === ''">
              <i class="bi bi-chat-dots"></i> Yorum Ekle
            </button>
          </div>
        </div>

        <div class="course-actions">
          <button (click)="unenrollFromCourse(course.id)" class="btn btn-danger btn-sm">
            <i class="bi bi-trash"></i> Kurstan Ã‡Ä±k
          </button>
          <button (click)="viewCourseDetails(course.id)" class="btn btn-info btn-sm">
            <i class="bi bi-eye"></i> DetaylarÄ± GÃ¶r
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- EÄŸitmen GÃ¶rÃ¼nÃ¼mÃ¼ -->
  <div *ngIf="!isLoading && currentUser?.type === 'instructor'" class="instructor-section">
    <div class="section-header">
      <h3>KurslarÄ±m</h3>
      <button (click)="toggleAddCourseForm()" class="btn btn-primary">
        {{showAddCourseForm ? 'Ä°ptal' : 'Yeni Kurs Ekle'}}
      </button>
    </div>

    <!-- Yeni Kurs Ekleme Formu -->
    <div *ngIf="showAddCourseForm" class="add-course-form">
      <h4>Yeni Kurs Ekle</h4>
      <form (ngSubmit)="addCourse()">
        <div class="form-group">
          <label for="courseTitle">Kurs BaÅŸlÄ±ÄŸÄ±:</label>
          <input type="text" id="courseTitle" [(ngModel)]="newCourse.coursesTitle" name="courseTitle" required>
        </div>
        
        <div class="form-group">
          <label for="courseIcon">Ä°kon (emoji):</label>
          <input type="text" id="courseIcon" [(ngModel)]="newCourse.icon" name="courseIcon" placeholder="ðŸ“š">
        </div>
        
        <div class="form-group">
          <label for="courseDescription">AÃ§Ä±klama:</label>
          <textarea id="courseDescription" [(ngModel)]="newCourse.description" name="courseDescription" required></textarea>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn btn-success">Kurs Ekle</button>
          <button type="button" (click)="toggleAddCourseForm()" class="btn btn-secondary">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- Kurs Listesi -->
    <div *ngIf="userCourses.length === 0" class="no-courses">
      <p>HenÃ¼z hiÃ§ kurs oluÅŸturmadÄ±nÄ±z.</p>
    </div>
    
    <div *ngIf="userCourses.length > 0" class="courses-grid">
      <div *ngFor="let course of userCourses" class="course-card instructor-card">
        <!-- DÃ¼zenleme Modu -->
        <div *ngIf="editingCourse?.id === course.id" class="edit-form">
          <div class="form-group">
            <label>Kurs BaÅŸlÄ±ÄŸÄ±:</label>
            <input type="text" [(ngModel)]="editCourse.coursesTitle">
          </div>
          
          <div class="form-group">
            <label>Ä°kon:</label>
            <input type="text" [(ngModel)]="editCourse.icon">
          </div>
          
          <div class="form-group">
            <label>AÃ§Ä±klama:</label>
            <textarea [(ngModel)]="editCourse.description"></textarea>
          </div>
          
          <div class="form-actions">
            <button (click)="updateCourse()" class="btn btn-success">Kaydet</button>
            <button (click)="cancelEdit()" class="btn btn-secondary">Ä°ptal</button>
          </div>
        </div>

        <!-- Normal GÃ¶rÃ¼nÃ¼m -->
        <div *ngIf="editingCourse?.id !== course.id">
          <div class="course-icon">{{course.icon || 'ðŸ“š'}}</div>
          <h4>{{course.coursesTitle}}</h4>
          <p>{{course.description}}</p>
          <p class="course-id">ID: {{course.id}}</p>
          
          <div class="course-actions">
            <button (click)="startEditCourse(course)" class="btn btn-edit">DÃ¼zenle</button>
            <button (click)="deleteCourse(course.id)" class="btn btn-delete">Sil</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>