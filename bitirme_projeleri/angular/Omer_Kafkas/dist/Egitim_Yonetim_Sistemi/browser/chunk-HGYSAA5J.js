import{a as g}from"./chunk-VC2N4P2G.js";import{Eb as h,Q as p,V as m,ha as f,m as r,r as u,x as d}from"./chunk-OPCDAKPE.js";var y=class i{api=m(g);cache=new Map;loading=f(!1);loadingState=h(()=>this.loading());search(n){let t=n.trim().toLowerCase();return t?this.cache.has(t)?r(this.cache.get(t)):(this.loading.set(!0),d({courses:this.api.list("courses"),users:this.api.list("users"),lessons:this.api.list("lessons"),comments:this.api.list("comments")}).pipe(u(({courses:b,users:C,lessons:I,comments:w})=>{let o=[];for(let e of b)[e.title,e.description,e.instructorName].some(s=>typeof s=="string"&&s.toLowerCase().includes(t))&&o.push({type:"course",id:e.id,title:e.title,subtitle:e.instructorName,relatedCourseId:e.id});for(let e of C){let s=[e.name,e.surname,e.email].filter(Boolean).join(" ");s.toLowerCase().includes(t)&&o.push({type:"user",id:e.id,title:s,subtitle:e.role||"kullan\u0131c\u0131"})}for(let e of I)e.title?.toLowerCase().includes(t)&&o.push({type:"lesson",id:e.id,title:e.title,relatedCourseId:e.courseId});for(let e of w)e.text?.toLowerCase().includes(t)&&o.push({type:"comment",id:e.id,title:e.text.slice(0,60)+(e.text.length>60?"\u2026":""),relatedCourseId:e.courseId});return o.sort((e,s)=>{let a={course:0,lesson:1,comment:2,user:3},l=a[e.type],c=a[s.type];return l!==c?l-c:e.title.localeCompare(s.title)}),this.cache.set(t,o),this.loading.set(!1),o}))):r([])}static \u0275fac=function(t){return new(t||i)};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})};export{y as a};
