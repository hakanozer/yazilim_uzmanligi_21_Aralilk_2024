import{Q as u,V as c,c as a,fc as m,ha as p,jc as g,r as l}from"./chunk-OPCDAKPE.js";var d=class e{http=c(m);api=g.apiBaseUrl;currentUser=p(this.loadUserFromStorage());loadUserFromStorage(){if(typeof window>"u")return null;let r=localStorage.getItem("currentUser");if(!r)return null;try{return JSON.parse(r)}catch{return null}}register(r){return this.http.post(`${this.api}/users`,r)}login(r,t){return this.http.get(`${this.api}/users`,{params:{email:r}}).pipe(l(f=>{let s=f.find(o=>o.password===t);if(s){let n=s,{password:o}=n,i=a(n,["password"]);this.currentUser.set(i),localStorage.setItem("currentUser",JSON.stringify(i))}else this.currentUser.set(null),localStorage.removeItem("currentUser");return s??null}))}logout(){this.currentUser.set(null),localStorage.removeItem("currentUser")}static \u0275fac=function(t){return new(t||e)};static \u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"})};export{d as a};
