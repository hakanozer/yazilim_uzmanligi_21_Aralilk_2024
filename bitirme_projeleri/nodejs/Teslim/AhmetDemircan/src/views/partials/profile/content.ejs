<section class="card settings-content">
  <% if (tab === 'edit') { %>
    <div class="section">
      <h2>Profil Fotoğrafı</h2>
      <div id="avatarMessages" class="messages"></div>
      <form id="avatarForm" enctype="multipart/form-data">
        <div class="avatar-row">
          <img src="<%= user?.profilePicture || '/images/default-avatar.svg' %>" alt="Profil" id="avatarPreview" class="avatar-preview" />
          <div class="form-group">
            <input id="avatar" name="avatar" type="file" accept=".png,.jpg,.jpeg,.webp,image/png,image/jpeg,image/webp" />
            <span class="hint">PNG, JPG, JPEG, WEBP • en fazla 2MB</span>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn">Yükle</button>
        </div>
      </form>

      <hr />

      <h2>Profil Bilgileri</h2>
      <div id="infoMessages" class="messages"></div>
      <form id="infoForm">
        <div class="form-row">
          <div class="form-group">
            <label for="name">Ad</label>
            <input id="name" name="name" type="text" value="<%= user?.name || '' %>" />
          </div>
          <div class="form-group">
            <label for="email">E-posta</label>
            <input id="email" name="email" type="email" value="<%= user?.email || '' %>" />
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn">Kaydet</button>
        </div>
      </form>

      <hr />

      <h2>Şifre Değiştir</h2>
      <div id="pwdMessages" class="messages"></div>
      <form id="pwdForm">
        <div class="form-row">
          <div class="form-group">
            <label for="currentPassword">Mevcut Şifre</label>
            <input id="currentPassword" name="currentPassword" type="password" />
          </div>
          <div class="form-group">
            <label for="newPassword">Yeni Şifre</label>
            <input id="newPassword" name="newPassword" type="password" />
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn">Değiştir</button>
          <span class="hint">Minimum 8 karakter olmalı.</span>
        </div>
      </form>

      <hr />

      <h2>Hesabı Sil</h2>
      <div id="accountMessages" class="messages"></div>
      <p class="hint">Bu işlem kalıcıdır ve geri alınamaz.</p>
      <button type="button" id="deleteAccountBtn" class="btn btn-danger">Hesabımı sil</button>
    </div>
  <% } else if (tab === 'privacy') { %>
    <div class="section">
      <h2>Hesap Gizliliği</h2>
      <p class="hint">Bu ayarlar örnek amaçlıdır; backend entegrasyonu eklenebilir.</p>
      <div class="form-group">
        <label><input type="checkbox" disabled /> Profilim herkese açık (yakında)</label>
      </div>
      <div class="form-group">
        <label><input type="checkbox" disabled /> Arama motorları profilimi indekslesin (yakında)</label>
      </div>
    </div>
  <% } else if (tab === 'comments') { %>
    <%- include('./comments') %>
  <% } else if (tab === 'blogs') { %>
    <div class="section section-blogs">
      <h2>
        <%= (user && Array.isArray(user.roles) && user.roles.includes('admin'))
            ? 'Site içeriği'
            : ((user && Array.isArray(user.roles) && user.roles.includes('author')) ? 'Bloglarım, Haberlerim' : 'Bloglarım') %>
      </h2>
      <div id="blogsMessages" class="messages"></div>

      <% if (user && Array.isArray(user.roles) && user.roles.includes('admin')) { %>
        <div class="admin-searchbar" role="search">
          <input type="search" id="adminSearchInput" placeholder="Haber ve bloglarda ara..." aria-label="İçerik ara" />
          <button id="adminSearchBtn" class="btn btn-sm">Ara</button>
          <button id="adminSearchClear" class="btn btn-sm">Temizle</button>
        </div>

        <div class="admin-content-grid">
          <section>
            <h3>Haberler</h3>
            <div id="adminNewsContainer" class="admin-list-grid"></div>
          </section>
          <section>
            <h3>Bloglar</h3>
            <div id="adminBlogsContainer" class="admin-list-grid"></div>
          </section>
        </div>

        <div class="admin-pagination">
          <button id="adminPrevPage" class="btn btn-sm">Önceki</button>
          <span id="adminPageLabel" class="muted"></span>
          <button id="adminNextPage" class="btn btn-sm">Sonraki</button>
        </div>
      <% } else { %>
        <% if (user && Array.isArray(user.roles) && user.roles.includes('author')) { %>
          <div class="admin-content-grid">
            <section>
              <h3>Haberlerim</h3>
              <div id="myNewsContainer" class="admin-list-grid"></div>
            </section>
            <section>
              <h3>Bloglarım</h3>
              <div id="myBlogsContainer" class="admin-list-grid"></div>
            </section>
          </div>
          <div class="admin-pagination">
            <button id="myContentPrev" class="btn btn-sm">Önceki</button>
            <span id="myContentPageLabel" class="muted"></span>
            <button id="myContentNext" class="btn btn-sm">Sonraki</button>
          </div>
        <% } else { %>
          <div id="myBlogsContainer" class="blog-grid"></div>
        <% } %>
      <% } %>
    </div>
  <% } else if (tab === 'users') { %>
    <% if (user && Array.isArray(user.roles) && user.roles.includes('admin')) { %>
      <%- include('./users') %>
    <% } else { %>
      <div class="section">
        <h2>Erişim yok</h2>
        <p class="hint">Bu bölümü yalnızca admin kullanıcılar görebilir.</p>
      </div>
    <% } %>
  <% } %>
</section>